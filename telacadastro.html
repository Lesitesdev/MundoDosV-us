<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cadastro - Mundo dos V√©us</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
</head>
<body class="bg-pink-50 text-gray-800">

  <!-- Inclui o HEADER -->
  <header class="bg-white shadow-md px-6 py-4 flex justify-between items-center">
    <a href="#" class="text-2xl font-bold text-purple-700">Mundo dos V√©us</a>
    <div class="flex items-center gap-6">
      <nav class="hidden md:flex gap-4 font-medium text-gray-700">
        <a href="#">Home</a>
        <a href="#produtos">Produtos</a>
        <a href="#">Sobre</a>
        <a href="#">Contato</a>
      </nav>
      <div class="search-box hidden md:block">
        <input type="text" placeholder="Buscar...">
      </div>
      <div class="flex gap-4 text-lg">
        <a href="#">üõí</a>
        <a href="#">üë§ Login</a>
      </div>
    </div>
  </header>

  <!-- CONTE√öDO PRINCIPAL -->
  <main class="flex items-center justify-center py-20 px-4">
    <div class="w-full max-w-lg bg-white p-8 rounded-2xl shadow-lg">
      <h2 class="text-2xl font-bold text-center text-pink-700 mb-6">Criar Conta</h2>
      <form id="signup-form">
        <!-- Nome e Sobrenome -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">Nome</label>
            <input type="text" id="first-name" class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-200 focus:outline-none" placeholder="Maria" required />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Sobrenome</label>
            <input type="text" id="last-name" class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-200 focus:outline-none" placeholder="Silva" required />
          </div>
        </div>

        <!-- Email e Telefone -->
        <div class="mt-4">
          <label class="block text-sm font-medium text-gray-700">E-mail</label>
          <input type="email" id="email" class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-200 focus:outline-none" placeholder="seuemail@exemplo.com" required />
        </div>

        <div class="mt-4">
          <label class="block text-sm font-medium text-gray-700">Telefone</label>
          <input type="tel" id="phone" class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-200 focus:outline-none" placeholder="(11) 91234-5678" required maxlength="15" oninput="mascaraTelefone(event)" />
        </div>

        <!-- Endere√ßo -->
        <div class="mt-4">
          <label class="block text-sm font-medium text-gray-700">Endere√ßo (Rua e N√∫mero)</label>
          <input type="text" id="address" class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-200 focus:outline-none" placeholder="Rua Exemplo, 123" required />
        </div>

        <!-- CEP, Cidade e Estado -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">CEP</label>
            <input type="text" id="cep" class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-200 focus:outline-none" placeholder="00000-000" required />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Cidade</label>
            <input type="text" id="city" class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-200 focus:outline-none" placeholder="S√£o Paulo" required />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Estado</label>
            <input type="text" id="state" class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-200 focus:outline-none" placeholder="SP" required />
          </div>
        </div>

        <!-- Senha e Confirma√ß√£o de Senha -->
        <div class="mt-4">
          <label class="block text-sm font-medium text-gray-700">Senha</label>
          <input type="password" id="password" class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-200 focus:outline-none" placeholder="********" required />
        </div>

        <div class="mt-4">
          <label class="block text-sm font-medium text-gray-700">Confirme sua Senha</label>
          <input type="password" id="confirm-password" class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-200 focus:outline-none" placeholder="********" required />
        </div>

        ...
  <!-- Bot√£o de Cadastro -->
  <div class="mt-6">
    <button type="submit" class="w-full bg-pink-600 hover:bg-pink-700 text-white font-semibold py-2 rounded-lg transition">Cadastrar</button>
  </div>
</form>

<!-- Link para Login -->
<p class="mt-4 text-sm text-center text-gray-600">
  J√° tem conta?
  <a href="/login.html" class="text-pink-600 hover:underline font-medium">Entrar aqui</a>
</p>

<!-- Mensagem de sucesso -->
<div id="success-message" class="mt-4 text-green-600 font-semibold text-center hidden">
  Cadastro realizado com sucesso! Verifique seu email para a confirma√ß√£o.
</div>

<!-- Spinner de Carregamento -->
<div id="loading-spinner" class="hidden text-center">
  <div class="w-16 h-16 border-4 border-t-4 border-pink-600 border-solid rounded-full animate-spin"></div>
</div>

</div>
</main>

<!-- Inclui o FOOTER -->
<footer class="bg-purple-800 text-white py-10">
  <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-8 px-4">
    <div>
      <h4 class="font-bold mb-2">Contato</h4>
      <p>üì± WhatsApp: (11) 91234-5678</p>
      <p>‚úâÔ∏è Email: contato@mundodosveus.com</p>
    </div>
    <div>
      <h4 class="font-bold mb-2">Links √öteis</h4>
      <ul>
        <li><a href="#" class="hover:underline">Pol√≠tica de Troca</a></li>
        <li><a href="#" class="hover:underline">Frete e Entrega</a></li>
        <li><a href="#" class="hover:underline">Termos e Condi√ß√µes</a></li>
      </ul>
    </div>
    <div>
      <h4 class="font-bold mb-2">Redes Sociais</h4>
      <p><a href="#" class="hover:underline">Instagram</a></p>
      <p><a href="#" class="hover:underline">Facebook</a></p>
      <p><a href="#" class="hover:underline">Pinterest</a></p>
    </div>
    <div>
      <h4 class="font-bold mb-2">Formas de Pagamento</h4>
      <p>üí≥ Cart√µes | Pix | Boleto</p>
      <img src="https://www.mercadopago.com.br/org-img/MP3/home/logos/visa.gif" alt="Visa" class="inline w-10">
      <img src="https://www.mercadopago.com.br/org-img/MP3/home/logos/master.gif" alt="MasterCard" class="inline w-10">
      <img src="https://www.mercadopago.com.br/org-img/MP3/home/logos/pix.gif" alt="Pix" class="inline w-10">
    </div>
  </div>
  <p class="text-center mt-6 text-sm text-purple-200">¬© 2025 Mundo dos V√©us. Todos os direitos reservados.</p>
</footer>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, sendEmailVerification } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-auth.js";
  import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-firestore.js";
  
  const firebaseConfig = {
    apiKey: "AIzaSyD9FSLA-EOGRgvDbbaBqBge7j8gRl4WJkI",
    authDomain: "loja-de-veus.firebaseapp.com",
    projectId: "loja-de-veus",
    storageBucket: "loja-de-veus.firebasestorage.app",
    messagingSenderId: "907809130966",
    appId: "1:907809130966:web:800dae192863cddbc2fc77",
    measurementId: "G-XDRVKSRMQP"
  };
  
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  
  document.getElementById('signup-form').addEventListener('submit', async function (e) {
    e.preventDefault();
  
    // Mostrar spinner
    document.getElementById('loading-spinner').classList.remove('hidden');
    
    const firstName = document.getElementById('first-name').value;
    const lastName = document.getElementById('last-name').value;
    const email = document.getElementById('email').value;
    const phone = document.getElementById('phone').value;
    const address = document.getElementById('address').value;
    const cep = document.getElementById('cep').value;
    const city = document.getElementById('city').value;
    const state = document.getElementById('state').value;
    const password = document.getElementById('password').value;
    const confirmPassword = document.getElementById('confirm-password').value;
  
    // Valida√ß√µes
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
      alert("Por favor, insira um e-mail v√°lido.");
      return;
    }
  
    // Valida√ß√£o de senha
    if (password.length < 6) {
      alert("A senha deve ter no m√≠nimo 6 caracteres.");
      return;
    }
  
    if (password !== confirmPassword) {
      alert("As senhas n√£o coincidem.");
      return;
    }
  
    try {
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;
  
      // Salvar dados no Firestore
      await setDoc(doc(db, "usuarios", user.uid), {
        nome: firstName,
        sobrenome: lastName,
        email: email,
        telefone: phone,
        endereco: address,
        cep: cep,
        cidade: city,
        estado: state,
        criadoEm: new Date()
      });
  
      await sendEmailVerification(user);
  
      // Esconder spinner e mostrar mensagem de sucesso
      document.getElementById('loading-spinner').classList.add('hidden');
      document.getElementById('success-message').classList.remove('hidden');
  
      // Redirecionar para login ap√≥s 2 segundos
      setTimeout(function() {
        window.location.href = "/login"; // Redireciona para a p√°gina de login
      }, 2000);
  
    } catch (error) {
      console.error("Erro ao cadastrar:", error);
      // Verificar se o e-mail j√° est√° cadastrado
      if (error.code === "auth/email-already-in-use") {
        alert("Este e-mail j√° est√° cadastrado. Fa√ßa login ou use outro e-mail.");
      } else {
        alert(error.message);
      }
  
      // Esconder spinner ap√≥s erro
      document.getElementById('loading-spinner').classList.add('hidden');
    }
  });
  
  // M√°scara de telefone
  window.mascaraTelefone = function (event) {
    let telefone = event.target.value.replace(/\D/g, "");
    if (telefone.length >= 11) {
      telefone = telefone.replace(/(\d{2})(\d{5})(\d{4})/, "($1) $2-$3");
    } else {
      telefone = telefone.replace(/(\d{2})(\d{4})(\d{4})/, "($1) $2-$3");
    }
    event.target.value = telefone;
  };

  document.getElementById('signup-form').addEventListener('submit', async function (e) {
  e.preventDefault();

  // Desabilitar o bot√£o de cadastro para evitar m√∫ltiplos cliques
  const submitButton = document.querySelector('button[type="submit"]');
  submitButton.disabled = true;

  // Mostrar spinner enquanto espera
  document.getElementById('loading-spinner').classList.remove('hidden');

  const firstName = document.getElementById('first-name').value;
  const lastName = document.getElementById('last-name').value;
  const email = document.getElementById('email').value;
  const phone = document.getElementById('phone').value;
  const address = document.getElementById('address').value;
  const cep = document.getElementById('cep').value;
  const city = document.getElementById('city').value;
  const state = document.getElementById('state').value;
  const password = document.getElementById('password').value;
  const confirmPassword = document.getElementById('confirm-password').value;

  // Valida√ß√µes
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!emailRegex.test(email)) {
    alert("Por favor, insira um e-mail v√°lido.");
    submitButton.disabled = false;
    document.getElementById('loading-spinner').classList.add('hidden');
    return;
  }

  if (password.length < 6) {
    alert("A senha deve ter no m√≠nimo 6 caracteres.");
    submitButton.disabled = false;
    document.getElementById('loading-spinner').classList.add('hidden');
    return;
  }

  if (password !== confirmPassword) {
    alert("As senhas n√£o coincidem.");
    submitButton.disabled = false;
    document.getElementById('loading-spinner').classList.add('hidden');
    return;
  }

  try {
    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
    const user = userCredential.user;

    // Salvar dados no Firestore
    await setDoc(doc(db, "usuarios", user.uid), {
  nome: firstName,
  sobrenome: lastName,
  email: email,
  telefone: phone,
  endereco: address,
  cep: cep,
  cidade: city,
  estado: state,
  criadoEm: new Date()
});

    

    await sendEmailVerification(user);

    // Esconder spinner e mostrar mensagem de sucesso
    document.getElementById('loading-spinner').classList.add('hidden');
    document.getElementById('success-message').classList.remove('hidden');

    // Redirecionar para login ap√≥s 2 segundos
    setTimeout(function () {
      window.location.href = "/login"; // Redireciona para a p√°gina de login
    }, 2000);

  } catch (error) {
    console.error("Erro ao cadastrar:", error);

    // Verificar se o erro √© de e-mail j√° utilizado
    if (error.code === "auth/email-already-in-use") {
      alert("Este e-mail j√° est√° cadastrado. Fa√ßa login ou use outro e-mail.");
    } else {
      alert("Ocorreu um erro inesperado: " + error.message);
    }

    // Reabilitar o bot√£o e esconder o spinner ap√≥s erro
    submitButton.disabled = false;
    document.getElementById('loading-spinner').classList.add('hidden');
  }
});

</script>
<script src="/carrinho.js"></script>

</body>
</html>

  
  

